<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Taller 3b</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Taller 3b_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller 3b_files/libs/quarto-html/quarto.js"></script>
<script src="Taller 3b_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller 3b_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller 3b_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller 3b_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller 3b_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller 3b_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller 3b_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller 3b_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller 3b</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="logo-ie-ciae.gif" class="img-fluid quarto-figure quarto-figure-left figure-img" width="200"></p>
</figure>
</div>
<section id="análisis-de-regresión-logística" class="level1">
<h1>Análisis de Regresión Logística 📈</h1>
<p>En esta sesión, aprenderás a realizar un análisis de regresión logística utilizando datos de matrícula de educación superior de los años 2021 y 2022. La regresión logística es una técnica estadística utilizada para modelar la probabilidad de ocurrencia de un evento binario, como la deserción de estudiantes, en función de una o más variables independientes. Exploraremos cómo preparar los datos, ajustar el modelo, evaluar los supuestos, interpretar los resultados y visualizar las relaciones entre las variables.</p>
<p>Comencemos estableciendo el directorio de trabajo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>() <span class="co"># Verifica el directorio de trabajo actual</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "G:/Mi unidad/Teaching/Metodología Cuantitativa II 2024/Sesión 3"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"G:/Mi unidad/Teaching/Metodología Cuantitativa II 2024/Sesión 3"</span>) <span class="co"># Cambia esta línea de código por tu directorio de trabajo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="instalar-y-cargar-paquetes" class="level2">
<h2 class="anchored" data-anchor-id="instalar-y-cargar-paquetes">Instalar y Cargar Paquetes</h2>
<p>Instalemos y carguemos los paquetes que utilizaremos en esta sesión usando el paquete <code>pacman</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, <span class="co"># tidyverse es en realidad una colección de paquetes muy popular, que incluye ggplot2, dplyr, etc</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>               corrplot,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>               GGally,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>               lmtest,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>               DescTools,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>               car,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>               reshape2,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>               tidymodels,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>               knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importar-datos" class="level2">
<h2 class="anchored" data-anchor-id="importar-datos">Importar Datos</h2>
<p>Importamos los datos de matrícula de educación superior para los años 2021 y 2022. Luego, seleccionamos la cohorte de estudiantes que ingresaron en 2021 para estudiar la deserción en su primer año.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importar los datos de matrícula para 2021 y 2022</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>mat2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"20230802_Matrícula_Ed_Superior_2021_PUBL_MRUN.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">";"</span>) </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>mat2022 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"20230802_Matrícula_Ed_Superior_2022_PUBL_MRUN.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">";"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="selección-y-manipulación" class="level2">
<h2 class="anchored" data-anchor-id="selección-y-manipulación">Selección y manipulación</h2>
<p>Parte importante del análisis de datos es la creación, transformación, limpieza y recodificación de datos para los propósitos que se busca. Aprendamos un poco acerca de aquellos con este trozo de código donde seleccionamos casos según cohorte y crearemos una nueva variable dependiente dicotómica que nos señalará deserción universitaria en base a estos dos conjuntos de datos de <code>mat2021</code> y <code>mat2022</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección de casos: Cohorte que ingresó en 2021</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>mat2021_1anio <span class="ot">&lt;-</span> mat2021[<span class="fu">which</span>(mat2021<span class="sc">$</span>anio_ing_carr_ori <span class="sc">==</span> <span class="st">"2021"</span>),]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>mat2022_2anio <span class="ot">&lt;-</span> mat2022[<span class="fu">which</span>(mat2022<span class="sc">$</span>anio_ing_carr_ori <span class="sc">==</span> <span class="st">"2021"</span>),]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generación de variable dependiente: Indicador de Deserción</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>mat2021_1anio<span class="sc">$</span>deserta <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mat2021_1anio<span class="sc">$</span>mrun <span class="sc">%in%</span> mat2022_2anio<span class="sc">$</span>mrun, <span class="st">"0"</span>, <span class="st">"1"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>mat2021_1anio<span class="sc">$</span>deserta <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mat2021_1anio<span class="sc">$</span>deserta)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionamos solo a estudiantes de pregrado</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>mat2021_1anio <span class="ot">&lt;-</span> mat2021_1anio[<span class="fu">which</span>(mat2021_1anio<span class="sc">$</span>nivel_global <span class="sc">==</span> <span class="st">"Pregrado"</span>),]</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploración de los datos</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mat2021_1anio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cat_periodo      id    codigo_unico mrun gen_alu fec_nac_alu   rango_edad
4         2021  794616   I111S22C8J1V1   98       2      200212 15 a 19 años
5         2021  755594 I111S12C420J1V1   99       1      200301 15 a 19 años
7         2021 1131128 I430S10C326J1V1  137       1      200104 20 a 24 años
8         2021  754806 I111S12C413J1V1  140       1      200106 20 a 24 años
15        2021   71451  I13S10C384J2V2  341       2      198803 30 a 34 años
19        2021  622982   I90S1C114J1V2  392       1      200101 20 a 24 años
   anio_ing_carr_ori sem_ing_carr_ori anio_ing_carr_act sem_ing_carr_act
4               2021                1              2021                1
5               2021                1              2021                1
7               2021                1              2021                1
8               2021                1              2021                1
15              2021                1              2021                1
19              2021                1              2021                1
                    tipo_inst_1                  tipo_inst_2
4      Institutos Profesionales     Institutos Profesionales
5      Institutos Profesionales     Institutos Profesionales
7  Centros de Formación Técnica Centros de Formación Técnica
8      Institutos Profesionales     Institutos Profesionales
15                Universidades       Universidades Privadas
19                Universidades          Universidades CRUCH
                    tipo_inst_3 cod_inst                    nomb_inst cod_sede
4      Institutos Profesionales      111                   IP DUOC UC       22
5      Institutos Profesionales      111                   IP DUOC UC       12
7  Centros de Formación Técnica      430                   CFT INACAP       10
8      Institutos Profesionales      111                   IP DUOC UC       12
15       Universidades Privadas       13      UNIVERSIDAD SANTO TOMAS       10
19 Universidades Privadas CRUCH       90 UNIVERSIDAD AUSTRAL DE CHILE        1
                     nomb_sede cod_carrera
4  SEDE PADRE ALONSO DE OVALLE           8
5             SEDE PUENTE ALTO         420
7                   SEDE RENCA         326
8             SEDE PUENTE ALTO         413
15                 SEDE TEMUCO         384
19                CASA CENTRAL         114
                                             nomb_carrera  modalidad    jornada
4                                             GASTRONOMIA Presencial     Diurno
5                TECNICO EN GEOLOGIA Y CONTROL EN SONDAJE Presencial     Diurno
7       TECNICO EN MECANICA Y ELECTROMOVILIDAD AUTOMOTRIZ Presencial     Diurno
8  INGENIERIA EN ELECTRICIDAD Y AUTOMATIZACION INDUSTRIAL Presencial     Diurno
15             PROGRAMA DE LICENCIATURA DE TRABAJO SOCIAL Presencial Vespertino
19                              INGENIERIA CIVIL ACUSTICA Presencial     Diurno
   version              tipo_plan_carr dur_estudio_carr dur_proceso_tit
4        1                Plan Regular                5               1
5        1                Plan Regular                5               1
7        1                Plan Regular                4               0
8        1                Plan Regular                8               1
15       2 Plan Regular de Continuidad                2               0
19       2                Plan Regular               11               0
   dur_total_carr   region_sede provincia_sede comuna_sede nivel_global
4               5 Metropolitana       SANTIAGO    SANTIAGO     Pregrado
5               5 Metropolitana     CORDILLERA PUENTE ALTO     Pregrado
7               4 Metropolitana       SANTIAGO       RENCA     Pregrado
8               8 Metropolitana     CORDILLERA PUENTE ALTO     Pregrado
15              2  La Araucanía         CAUTIN      TEMUCO     Pregrado
19             11      Los Ríos       VALDIVIA    VALDIVIA     Pregrado
                       nivel_carrera_1        nivel_carrera_2
4            Técnico de Nivel Superior      Carreras Técnicas
5            Técnico de Nivel Superior      Carreras Técnicas
7            Técnico de Nivel Superior      Carreras Técnicas
8         Profesional Sin Licenciatura Carreras Profesionales
15 Licenciatura No Conducente a Título Carreras Profesionales
19        Profesional Con Licenciatura Carreras Profesionales
    requisito_ingreso           vigencia_carrera formato_valores
4     Educación Media VIGENTE CON ALUMNOS NUEVOS              NA
5     Educación Media VIGENTE CON ALUMNOS NUEVOS              NA
7     Educación Media VIGENTE CON ALUMNOS NUEVOS              NA
8     Educación Media VIGENTE CON ALUMNOS NUEVOS              NA
15 Título Profesional VIGENTE CON ALUMNOS NUEVOS              NA
19    Educación Media VIGENTE CON ALUMNOS NUEVOS              NA
   valor_matricula valor_arancel codigo_demre         area_conocimiento
4           194000       2510000            0 Administración y Comercio
5           194000       2240000            0          Ciencias Básicas
7           260000       2212000            0                Tecnología
8           254000       2430000            0                Tecnología
15           93000       2097000            0         Ciencias Sociales
19          175000       3869000        17030                Tecnología
                         cine_f_97_area               cine_f_97_subarea
4                             Servicios            Servicios Personales
5                              Ciencias                Ciencias Físicas
7  Ingeniería, Industria y Construcción Ingeniería y Profesiones Afines
8  Ingeniería, Industria y Construcción Ingeniería y Profesiones Afines
15           Salud y Servicios Sociales              Servicios Sociales
19 Ingeniería, Industria y Construcción Ingeniería y Profesiones Afines
                   area_carrera_generica
4        Técnico en Gastronomía y Cocina
5                    Técnico en Geología
7         Técnico en Mecánica Automotriz
8             Ingeniería en Electricidad
15                        Trabajo Social
19 Ingeniería Civil en Sonido y Acústica
                                  cine_f_13_area
4                                      Servicios
5  Ciencias naturales, matemáticas y estadística
7           Ingeniería, Industria y Construcción
8           Ingeniería, Industria y Construcción
15                             Salud y Bienestar
19          Ingeniería, Industria y Construcción
                 cine_f_13_subarea acreditada_carr acreditada_inst
4             Servicios personales      ACREDITADA      ACREDITADA
5                 Ciencias Físicas   NO ACREDITADA      ACREDITADA
7  Ingeniería y Profesiones Afines SIN INFORMACIÓN      ACREDITADA
8  Ingeniería y Profesiones Afines   NO ACREDITADA      ACREDITADA
15                       Bienestar   NO ACREDITADA      ACREDITADA
19 Ingeniería y Profesiones Afines      ACREDITADA      ACREDITADA
      acre_inst_desde_hasta acre_inst_anio costo_proceso_titulacion
4  26/08/2017 AL 26/08/2024              7                       NA
5  26/08/2017 AL 26/08/2024              7                       NA
7  05/01/2018 AL 05/01/2025              7                       NA
8  26/08/2017 AL 26/08/2024              7                       NA
15 31/03/2021 AL 31/03/2025              4                       NA
19 12/11/2015 AL 12/11/2021              6                       NA
   costo_obtencion_titulo_diploma                forma_ingreso deserta
4                              NA 1- Ingreso Directo (regular)       0
5                              NA 1- Ingreso Directo (regular)       0
7                              NA 1- Ingreso Directo (regular)       1
8                              NA 1- Ingreso Directo (regular)       1
15                             NA 1- Ingreso Directo (regular)       1
19                             NA 1- Ingreso Directo (regular)       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mat2021_1anio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 322448     53</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mat2021_1anio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   322448 obs. of  53 variables:
 $ cat_periodo                   : int  2021 2021 2021 2021 2021 2021 2021 2021 2021 2021 ...
 $ id                            : int  794616 755594 1131128 754806 71451 622982 1145550 437898 974737 736304 ...
 $ codigo_unico                  : chr  "I111S22C8J1V1" "I111S12C420J1V1" "I430S10C326J1V1" "I111S12C413J1V1" ...
 $ mrun                          : int  98 99 137 140 341 392 427 428 452 637 ...
 $ gen_alu                       : int  2 1 1 1 2 1 1 1 2 2 ...
 $ fec_nac_alu                   : int  200212 200301 200104 200106 198803 200101 200102 200101 199801 200212 ...
 $ rango_edad                    : chr  "15 a 19 años" "15 a 19 años" "20 a 24 años" "20 a 24 años" ...
 $ anio_ing_carr_ori             : int  2021 2021 2021 2021 2021 2021 2021 2021 2021 2021 ...
 $ sem_ing_carr_ori              : int  1 1 1 1 1 1 1 1 1 1 ...
 $ anio_ing_carr_act             : int  2021 2021 2021 2021 2021 2021 2021 2021 2021 2021 ...
 $ sem_ing_carr_act              : int  1 1 1 1 1 1 1 1 1 1 ...
 $ tipo_inst_1                   : chr  "Institutos Profesionales" "Institutos Profesionales" "Centros de Formación Técnica" "Institutos Profesionales" ...
 $ tipo_inst_2                   : chr  "Institutos Profesionales" "Institutos Profesionales" "Centros de Formación Técnica" "Institutos Profesionales" ...
 $ tipo_inst_3                   : chr  "Institutos Profesionales" "Institutos Profesionales" "Centros de Formación Técnica" "Institutos Profesionales" ...
 $ cod_inst                      : int  111 111 430 111 13 90 430 75 143 103 ...
 $ nomb_inst                     : chr  "IP DUOC UC" "IP DUOC UC" "CFT INACAP" "IP DUOC UC" ...
 $ cod_sede                      : int  22 12 10 12 10 1 22 2 26 8 ...
 $ nomb_sede                     : chr  "SEDE PADRE ALONSO DE OVALLE" "SEDE PUENTE ALTO" "SEDE RENCA" "SEDE PUENTE ALTO" ...
 $ cod_carrera                   : int  8 420 326 413 384 114 175 54 110 1 ...
 $ nomb_carrera                  : chr  "GASTRONOMIA" "TECNICO EN GEOLOGIA Y CONTROL EN SONDAJE" "TECNICO EN MECANICA Y ELECTROMOVILIDAD AUTOMOTRIZ" "INGENIERIA EN ELECTRICIDAD Y AUTOMATIZACION INDUSTRIAL" ...
 $ modalidad                     : chr  "Presencial" "Presencial" "Presencial" "Presencial" ...
 $ jornada                       : chr  "Diurno" "Diurno" "Diurno" "Diurno" ...
 $ version                       : int  1 1 1 1 2 2 1 1 1 1 ...
 $ tipo_plan_carr                : chr  "Plan Regular" "Plan Regular" "Plan Regular" "Plan Regular" ...
 $ dur_estudio_carr              : int  5 5 4 8 2 11 4 10 8 8 ...
 $ dur_proceso_tit               : int  1 1 0 1 0 0 0 2 1 0 ...
 $ dur_total_carr                : int  5 5 4 8 2 11 4 10 8 8 ...
 $ region_sede                   : chr  "Metropolitana" "Metropolitana" "Metropolitana" "Metropolitana" ...
 $ provincia_sede                : chr  "SANTIAGO" "CORDILLERA" "SANTIAGO" "CORDILLERA" ...
 $ comuna_sede                   : chr  "SANTIAGO" "PUENTE ALTO" "RENCA" "PUENTE ALTO" ...
 $ nivel_global                  : chr  "Pregrado" "Pregrado" "Pregrado" "Pregrado" ...
 $ nivel_carrera_1               : chr  "Técnico de Nivel Superior" "Técnico de Nivel Superior" "Técnico de Nivel Superior" "Profesional Sin Licenciatura" ...
 $ nivel_carrera_2               : chr  "Carreras Técnicas" "Carreras Técnicas" "Carreras Técnicas" "Carreras Profesionales" ...
 $ requisito_ingreso             : chr  "Educación Media" "Educación Media" "Educación Media" "Educación Media" ...
 $ vigencia_carrera              : chr  "VIGENTE CON ALUMNOS NUEVOS" "VIGENTE CON ALUMNOS NUEVOS" "VIGENTE CON ALUMNOS NUEVOS" "VIGENTE CON ALUMNOS NUEVOS" ...
 $ formato_valores               : logi  NA NA NA NA NA NA ...
 $ valor_matricula               : int  194000 194000 260000 254000 93000 175000 220000 105000 190000 190000 ...
 $ valor_arancel                 : int  2510000 2240000 2212000 2430000 2097000 3869000 2064000 3325000 2230000 1900000 ...
 $ codigo_demre                  : int  0 0 0 0 0 17030 0 29055 0 0 ...
 $ area_conocimiento             : chr  "Administración y Comercio" "Ciencias Básicas" "Tecnología" "Tecnología" ...
 $ cine_f_97_area                : chr  "Servicios" "Ciencias" "Ingeniería, Industria y Construcción" "Ingeniería, Industria y Construcción" ...
 $ cine_f_97_subarea             : chr  "Servicios Personales" "Ciencias Físicas" "Ingeniería y Profesiones Afines" "Ingeniería y Profesiones Afines" ...
 $ area_carrera_generica         : chr  "Técnico en Gastronomía y Cocina" "Técnico en Geología" "Técnico en Mecánica Automotriz" "Ingeniería en Electricidad" ...
 $ cine_f_13_area                : chr  "Servicios" "Ciencias naturales, matemáticas y estadística" "Ingeniería, Industria y Construcción" "Ingeniería, Industria y Construcción" ...
 $ cine_f_13_subarea             : chr  "Servicios personales" "Ciencias Físicas" "Ingeniería y Profesiones Afines" "Ingeniería y Profesiones Afines" ...
 $ acreditada_carr               : chr  "ACREDITADA" "NO ACREDITADA" "SIN INFORMACIÓN" "NO ACREDITADA" ...
 $ acreditada_inst               : chr  "ACREDITADA" "ACREDITADA" "ACREDITADA" "ACREDITADA" ...
 $ acre_inst_desde_hasta         : chr  "26/08/2017 AL 26/08/2024" "26/08/2017 AL 26/08/2024" "05/01/2018 AL 05/01/2025" "26/08/2017 AL 26/08/2024" ...
 $ acre_inst_anio                : int  7 7 7 7 4 6 7 5 5 5 ...
 $ costo_proceso_titulacion      : logi  NA NA NA NA NA NA ...
 $ costo_obtencion_titulo_diploma: logi  NA NA NA NA NA NA ...
 $ forma_ingreso                 : chr  "1- Ingreso Directo (regular)" "1- Ingreso Directo (regular)" "1- Ingreso Directo (regular)" "1- Ingreso Directo (regular)" ...
 $ deserta                       : num  0 0 1 1 1 0 0 0 1 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificación de la variable género</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>mat2021_1anio<span class="sc">$</span>female <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mat2021_1anio<span class="sc">$</span>gen_alu)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>mat2021_1anio<span class="sc">$</span>female[mat2021_1anio<span class="sc">$</span>female <span class="sc">==</span> <span class="st">"1"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>mat2021_1anio<span class="sc">$</span>female[mat2021_1anio<span class="sc">$</span>female <span class="sc">==</span> <span class="st">"2"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la edad al ingreso en la educación superior</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>mat2021_1anio<span class="sc">$</span>anio_nac <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">str_sub</span>(mat2021_1anio<span class="sc">$</span>fec_nac_alu, <span class="dv">1</span>, <span class="dv">4</span>)) </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>mat2021_1anio<span class="sc">$</span>anio_ing_carr_ori <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mat2021_1anio<span class="sc">$</span>anio_ing_carr_ori)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>mat2021_1anio<span class="sc">$</span>edad_alu <span class="ot">&lt;-</span> mat2021_1anio<span class="sc">$</span>anio_ing_carr_ori <span class="sc">-</span> mat2021_1anio<span class="sc">$</span>anio_nac</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtramos datos erróneos de edad</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mat2021_1anio<span class="sc">$</span>edad_alu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  16.00   19.00   21.00   24.51   28.00   78.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mat2021_1anio <span class="ot">&lt;-</span> mat2021_1anio[<span class="sc">!</span>(mat2021_1anio<span class="sc">$</span>edad_alu <span class="sc">==</span> <span class="dv">121</span>),]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mat2021_1anio<span class="sc">$</span>edad_alu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  16.00   19.00   21.00   24.51   28.00   78.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar para eliminar NA's presentes en predictores para conformar la muestra analítica de interés</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>mat2021_1anio <span class="ot">&lt;-</span> <span class="fu">filter</span>(mat2021_1anio, <span class="sc">!</span><span class="fu">is.na</span>(female) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(edad_alu) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dur_total_carr) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(valor_arancel))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Removamos los data frames que no utilizaremos para liberar espacio de memoria RAM</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(mat2021, mat2022, mat2022_2anio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualización-de-la-variable-dependiente" class="level2">
<h2 class="anchored" data-anchor-id="visualización-de-la-variable-dependiente">Visualización de la Variable Dependiente</h2>
<p>Visualizamos la distribución de la variable dependiente deserta utilizando un gráfico de barras.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mat2021_1anio, <span class="fu">aes</span>(deserta, <span class="at">fill =</span> deserta)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Deserción"</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cantidad"</span>) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#87ceeb"</span>, <span class="st">"#ffd700"</span>)) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'top'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: fill.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3b_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="análisis-de-regresión-logística-1" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-regresión-logística-1">Análisis de Regresión Logística</h2>
<p>Ajustamos un modelo de regresión logística para predecir la deserción (<code>deserta</code>) en función de las variables <code>female</code> (género) y <code>edad_alu</code> (edad al ingreso).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(deserta <span class="sc">~</span> female <span class="sc">+</span> edad_alu, <span class="at">family =</span> <span class="fu">binomial</span>(logit), <span class="at">data =</span> mat2021_1anio)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = deserta ~ female + edad_alu, family = binomial(logit), 
    data = mat2021_1anio)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.9045970  0.0133115 -143.08   &lt;2e-16 ***
female      -0.2973079  0.0080415  -36.97   &lt;2e-16 ***
edad_alu     0.0430621  0.0004782   90.05   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 377619  on 322340  degrees of freedom
Residual deviance: 368362  on 322338  degrees of freedom
AIC: 368368

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<section id="evaluación-de-los-supuestos-de-la-regresión-logística" class="level3">
<h3 class="anchored" data-anchor-id="evaluación-de-los-supuestos-de-la-regresión-logística">Evaluación de los Supuestos de la Regresión Logística</h3>
<p>Es importante verificar que los supuestos de la regresión logística se cumplen para garantizar la validez de las estimaciones del modelo.</p>
<ul>
<li><strong>Variable dependiente categórica</strong>: La variable que estamos tratando de predecir (deserta) es binaria, lo que cumple con el primer supuesto.</li>
<li><strong>Independencia de las observaciones</strong>: Este supuesto no se evalúa estadísticamente, pero es importante asegurarse de que cada observación (estudiante) es independiente de las demás.</li>
<li><strong>Supuesto de Linealidad</strong>: implica que la relación entre el logit de la variable dependiente y cada variable independiente es lineal. Verificamos este supuesto usando el Test Box-Tidwell. Si el resultado del test es no significativo, no se rechaza la hipótesis nula de linealidad, lo que indica que el supuesto de linealidad se cumple.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>logodds <span class="ot">&lt;-</span> m2<span class="sc">$</span>linear.predictors</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxTidwell</span>(logodds <span class="sc">~</span> mat2021_1anio<span class="sc">$</span>edad_alu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> MLE of lambda Score Statistic (t) Pr(&gt;|t|)
       0.99355             -1.2948   0.1954

iterations =  1 </code></pre>
</div>
</div>
<ul>
<li><strong>Supuesto de Ausencia de Multicolinealidad</strong>: La multicolinealidad ocurre cuando las variables independientes están altamente correlacionadas entre sí. Evaluamos este supuesto utilizando la matriz de correlación y el Factor de Inflación de la Varianza (VIF). Si los valores de VIF son menores a 5, se considera que no hay un problema significativo de multicolinealidad. Si las correlacione son mayores a r &gt; .08, entonces también es un indicador de multicolinealidad.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustamos un modelo con más variables independientes</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>mat2021_1anio<span class="sc">$</span>valor_arancel <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mat2021_1anio<span class="sc">$</span>valor_arancel)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(deserta <span class="sc">~</span> female <span class="sc">+</span> edad_alu <span class="sc">+</span> dur_total_carr <span class="sc">+</span> valor_arancel, <span class="at">family =</span> <span class="fu">binomial</span>(logit), <span class="at">data =</span> mat2021_1anio)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = deserta ~ female + edad_alu + dur_total_carr + 
    valor_arancel, family = binomial(logit), data = mat2021_1anio)

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -3.097e-01  2.114e-02 -14.646  &lt; 2e-16 ***
female         -3.011e-01  8.174e-03 -36.832  &lt; 2e-16 ***
edad_alu        2.668e-02  5.204e-04  51.260  &lt; 2e-16 ***
dur_total_carr -1.607e-01  2.144e-03 -74.930  &lt; 2e-16 ***
valor_arancel  -2.932e-08  4.254e-09  -6.893 5.46e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 377619  on 322340  degrees of freedom
Residual deviance: 358352  on 322336  degrees of freedom
AIC: 358362

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlación entre variables independientes continuas</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>cormat <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(mat2021_1anio[, <span class="fu">c</span>(<span class="st">"edad_alu"</span>, <span class="st">"dur_total_carr"</span>, <span class="st">"valor_arancel"</span>)]), <span class="dv">2</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>melted_cormat <span class="ot">&lt;-</span> <span class="fu">melt</span>(cormat)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de la matriz de correlación</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> melted_cormat, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> value)) <span class="sc">+</span> </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3b_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular VIF</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">vif</span>(m3), <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">edad_alu</td>
<td style="text-align: right;">1.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dur_total_carr</td>
<td style="text-align: right;">1.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">valor_arancel</td>
<td style="text-align: right;">1.73</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Los resultados de estos análisis sugieren que se cumple el supuesto de ausencia de multicolinealidad entre las variables independientes del modelo.</p>
</section>
<section id="resultados-de-la-regresión-logística" class="level3">
<h3 class="anchored" data-anchor-id="resultados-de-la-regresión-logística">Resultados de la Regresión Logística</h3>
<p>Interpretamos los resultados del modelo ajustado <code>m3</code>, evaluando la significancia de los coeficientes, direccionalidad y tamaño de los coeficientes (Estimates en el output) y calculando las probabilidades estimadas. También, en regresión logística es posible obtener el pseudo R2 que nos muestra la proporción de la varianza explicada de nuestra variable dependiente por el modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = deserta ~ female + edad_alu + dur_total_carr + 
    valor_arancel, family = binomial(logit), data = mat2021_1anio)

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -3.097e-01  2.114e-02 -14.646  &lt; 2e-16 ***
female         -3.011e-01  8.174e-03 -36.832  &lt; 2e-16 ***
edad_alu        2.668e-02  5.204e-04  51.260  &lt; 2e-16 ***
dur_total_carr -1.607e-01  2.144e-03 -74.930  &lt; 2e-16 ***
valor_arancel  -2.932e-08  4.254e-09  -6.893 5.46e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 377619  on 322340  degrees of freedom
Residual deviance: 358352  on 322336  degrees of freedom
AIC: 358362

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PseudoR2</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  McFadden 
0.05102261 </code></pre>
</div>
</div>
<p>Los coeficientes de regresión logística son el logaritmo natural de los odds (log-odds) de que ocurra el evento de la variable dependiente, que en este caso es desertar o no. La forma más intuitiva de interpretarlos es elevar al cuadrado los exponentes para obtenerlos en razones de odds (odd-ratio), los cuales pueden ser interpretados como la probabilidad de que un evento ocurra respecto a que no ocurra. Calculemos aquello en el siguiente código.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>m3<span class="sc">$</span>coefficients <span class="co"># coeficientes en log-odds</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)         female       edad_alu dur_total_carr  valor_arancel 
 -3.096589e-01  -3.010757e-01   2.667501e-02  -1.606718e-01  -2.932296e-08 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(m3<span class="sc">$</span>coefficients) <span class="co"># coeficientes en odd ratios</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)         female       edad_alu dur_total_carr  valor_arancel 
     0.7336972      0.7400217      1.0270340      0.8515715      1.0000000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(m3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                   2.5 %    97.5 %
(Intercept)    0.7039144 0.7647416
female         0.7282592 0.7519723
edad_alu       1.0259869 1.0280819
dur_total_carr 0.8479997 0.8551576
valor_arancel  1.0000000 1.0000000</code></pre>
</div>
</div>
<p><strong>Interpretación</strong>: se puede señalar que, por cada unidad que aumenta la edad del estudiante <code>edad_alu</code>, entonces la probabilidad de desertar en primer año es del 3%.</p>
</section>
<section id="comparación-respecto-al-modelo-nulo" class="level3">
<h3 class="anchored" data-anchor-id="comparación-respecto-al-modelo-nulo">Comparación respecto al modelo nulo</h3>
<p>Al estimar un chi-cuadrado del modelo (<code>m3</code>), podemos evaluar si es significativamente mejor que el modelo nulo o vacío (i.e.&nbsp;que contiene solo el intercepto y ningún predictor).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la chi-cuadrado del modelo</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>modelChi <span class="ot">&lt;-</span> m3<span class="sc">$</span>null.deviance <span class="sc">-</span> m3<span class="sc">$</span>deviance</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>chidf <span class="ot">&lt;-</span> m3<span class="sc">$</span>df.null <span class="sc">-</span> m3<span class="sc">$</span>df.residual</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>chisq.prob <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(modelChi, chidf)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>chisq.prob  <span class="co"># Significancia del modelo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Por ejemplo, en el siguiente código podemos obtener la probabilidad de que una mujer de 19 años, en un programa de 5 semestres de duración y con un arancel de $2.510.000 deserte es de 27%</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades estimadas</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>mat2021_1anio<span class="sc">$</span>Probabilidades_estimadas <span class="ot">&lt;-</span> m3<span class="sc">$</span>fitted.values</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar algunas probabilidades estimadas</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(mat2021_1anio[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="fu">c</span>(<span class="st">"deserta"</span>, <span class="st">"female"</span>, <span class="st">"edad_alu"</span>, <span class="st">"dur_total_carr"</span>, <span class="st">"valor_arancel"</span>, <span class="st">"Probabilidades_estimadas"</span>)], <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">deserta</th>
<th style="text-align: right;">female</th>
<th style="text-align: right;">edad_alu</th>
<th style="text-align: right;">dur_total_carr</th>
<th style="text-align: right;">valor_arancel</th>
<th style="text-align: right;">Probabilidades_estimadas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2510000</td>
<td style="text-align: right;">0.27</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2240000</td>
<td style="text-align: right;">0.33</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2212000</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2430000</td>
<td style="text-align: right;">0.24</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2097000</td>
<td style="text-align: right;">0.47</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">3869000</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2064000</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3325000</td>
<td style="text-align: right;">0.19</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2230000</td>
<td style="text-align: right;">0.21</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1900000</td>
<td style="text-align: right;">0.19</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>La bondad de clasificación es un análisis para evaluar la capacidad predictiva del modelo a nivel de los estudiantes, indicándonos la proporción de estudiantes que han sido clasificados correctamente por el modelo. Como vemos en el siguiente código, la precisión de la predicción es del 73%, lo que indica que nuestro modelo logra una mejora razonable de las predicciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>probabilities <span class="ot">=</span> m3 <span class="sc">%&gt;%</span> <span class="fu">predict</span>(mat2021_1anio, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(probabilities)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6 
0.2727194 0.3321336 0.3813769 0.2436470 0.4717070 0.1601653 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">=</span> <span class="fu">ifelse</span>(probabilities <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(predicted <span class="sc">==</span> mat2021_1anio<span class="sc">$</span>deserta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7278348</code></pre>
</div>
</div>
</section>
<section id="visualización" class="level3">
<h3 class="anchored" data-anchor-id="visualización">Visualización</h3>
<p>Visualizamos los resultados del modelo de regresión logística ajustado, incluyendo la relación entre las variables independientes y la probabilidad de deserción.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>m3_augmented <span class="ot">&lt;-</span> <span class="fu">augment</span>(m3)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Relación entre edad al ingreso y deserción</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(m3_augmented, <span class="fu">aes</span>(edad_alu, deserta)) <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial), <span class="at">color =</span> <span class="st">"royalblue"</span>) <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">22</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_point(lwd = 3, alpha = 0.5): Ignoring unknown parameters:
`linewidth`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3b_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relación entre duración total de la carrera y deserción</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(m3_augmented, <span class="fu">aes</span>(dur_total_carr, deserta)) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial), <span class="at">color =</span> <span class="st">"royalblue"</span>) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">22</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_point(lwd = 3, alpha = 0.5): Ignoring unknown parameters:
`linewidth`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3b_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relación entre valor del arancel y deserción</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(m3_augmented, <span class="fu">aes</span>(valor_arancel, deserta)) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial), <span class="at">color =</span> <span class="st">"royalblue"</span>) <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">22</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_point(lwd = 3, alpha = 0.5): Ignoring unknown parameters:
`linewidth`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3b_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparación-de-modelos" class="level3">
<h3 class="anchored" data-anchor-id="comparación-de-modelos">Comparación de Modelos</h3>
<p>Finalmente, comparamos los modelos <code>m2</code> y <code>m3</code> para determinar cuál ajusta mejor a los datos. Los resultados indican que el modelo 3 ajusta significativamente mejor a los datos que el modelo 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2, m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: deserta ~ female + edad_alu
Model 2: deserta ~ female + edad_alu + dur_total_carr + valor_arancel
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1    322338     368362                          
2    322336     358352  2    10009 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>