<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Taller 3a</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Taller 3a_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller 3a_files/libs/quarto-html/quarto.js"></script>
<script src="Taller 3a_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller 3a_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller 3a_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller 3a_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller 3a_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller 3a_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller 3a_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller 3a_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller 3a</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="logo-ie-ciae.gif" class="img-fluid quarto-figure quarto-figure-left figure-img" width="200"></p>
</figure>
</div>
<section id="análisis-de-regresión-lineal" class="level1">
<h1>Análisis de Regresión Lineal 📈</h1>
<p>En esta sesión, aprenderás a realizar un análisis de regresión lineal simple y múltiple utilizando datos de PISA 2009 para Chile. Exploraremos cómo evaluar los supuestos del modelo de regresión, interpretar los resultados y visualizar las relaciones entre las variables. También, discutiremos cómo comparar diferentes modelos de regresión y cómo interpretar la importancia relativa de los predictores.</p>
<p>Al igual que en las sesiones previas, es importante comenzar estableciendo el directorio de trabajo, la cual refiere a la carpeta de tu computador donde se encuentran los datos que vamos a analizar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "G:/Mi unidad/Teaching/Metodología Cuantitativa II 2024/Sesión 3"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"G:/Mi unidad/Teaching/Metodología Cuantitativa II 2024/Sesión 3"</span>) <span class="co"># Cambia esta línea de código por tu directorio de trabajo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="instalar-y-cargar-paquetes" class="level2">
<h2 class="anchored" data-anchor-id="instalar-y-cargar-paquetes">Instalar y Cargar Paquetes</h2>
<p>Aprenderemos una forma alternativa de instalar y cargar paquetes usando <code>pacman</code>. El código a continuación verifica si el paquete <code>pacman</code> está instalado y, si no lo está, lo instala. Luego, instala y carga todos los paquetes mencionados utilizando <code>pacman::p_load</code>, que instala y carga automáticamente cualquier paquete que no esté ya instalado. Siempre puedes también ocupar las funciones de R base de <code>install.packages()</code> y <code>library()</code>, aunque como ves esta es una alternativa más fácil de leer, especialente cuando trabajas con muchos paquetes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(haven,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>               ggplot2,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>               gmodels,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>               psych,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>               corrplot,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>               lmtest,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>               broom,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>               relaimpo,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>               visreg,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>               performance,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>               see,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>               patchwork,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>               knitr,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>               car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importar-datos" class="level2">
<h2 class="anchored" data-anchor-id="importar-datos">Importar Datos</h2>
<p>A continuación, importamos los datos de PISA 2009 para Chile. Utilizaremos el paquete <code>haven</code> para manejar los archivos SPSS (.sav).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pisa2009_chl <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">"pisa2009_chl.sav"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploración-inicial-de-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="exploración-inicial-de-los-datos">Exploración Inicial de los Datos</h2>
<p>Antes de proceder al análisis, es importante entender la estructura y el contenido del conjunto de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(pisa2009_chl)    <span class="co"># Verifica la clase del objeto 'pisa2009_chl'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pisa2009_chl)     <span class="co"># Muestra los primeros 6 casos de la base de datos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 13
  ctry      school id    sex        ses       sesj     math  read  scie type    
  &lt;chr+lbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;dbl+lbl&gt;  &lt;dbl+lbl&gt; &lt;dbl+l&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl+lb&gt;
1 152 [CHL] 00001  00003 1 [Female] -0.291    -1.45    414.  534.  480. NA      
2 152 [CHL] 00001  00002 1 [Female] -0.798    -1.45    347.  396.  414. NA      
3 152 [CHL] 00001  00005 1 [Female] -2.55     -1.45    391.  457.  392. NA      
4 152 [CHL] 00001  00001 1 [Female] -2.31     -1.45    417.  451.  408. NA      
5 152 [CHL] 00001  00004 1 [Female] -1.32     -1.45    422.  460.  438. NA      
6 152 [CHL] 00002  00016 1 [Female] -0.266    -0.674   403.  491.  495.  2 [Pri…
# ℹ 3 more variables: public &lt;dbl+lbl&gt;, subv &lt;dbl+lbl&gt;, priv &lt;dbl+lbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pisa2009_chl)    <span class="co"># Lista los nombres de las variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ctry"   "school" "id"     "sex"    "ses"    "sesj"   "math"   "read"  
 [9] "scie"   "type"   "public" "subv"   "priv"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pisa2009_chl)      <span class="co"># Muestra el número de variables y casos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5669   13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pisa2009_chl)  <span class="co"># Proporciona un resumen estadístico para cada variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ctry              school               id                 sex        
 Length:5669        Length:5669        Length:5669        Min.   :0.0000  
 Class :character   Class :character   Class :character   1st Qu.:0.0000  
 Mode  :character   Mode  :character   Mode  :character   Median :0.0000  
                                                          Mean   :0.4937  
                                                          3rd Qu.:1.0000  
                                                          Max.   :1.0000  
                                                                          
      ses               sesj                math            read      
 Min.   :-4.2451   Min.   :-2.680900   Min.   :194.7   Min.   :145.8  
 1st Qu.:-1.3480   1st Qu.:-1.089056   1st Qu.:370.0   1st Qu.:397.2  
 Median :-0.5661   Median :-0.770568   Median :421.3   Median :455.2  
 Mean   :-0.5056   Mean   :-0.509685   Mean   :424.8   Mean   :453.5  
 3rd Qu.: 0.3615   3rd Qu.: 0.009215   3rd Qu.:477.6   3rd Qu.:509.3  
 Max.   : 2.8814   Max.   : 1.538684   Max.   :782.1   Max.   :711.0  
 NA's   :89        NA's   :1                                          
      scie            type           public            subv       
 Min.   :144.3   Min.   :1.000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:394.7   1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:0.0000  
 Median :450.1   Median :2.000   Median :0.0000   Median :0.0000  
 Mean   :451.6   Mean   :1.559   Mean   :0.4778   Mean   :0.4852  
 3rd Qu.:505.2   3rd Qu.:2.000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :730.8   Max.   :3.000   Max.   :1.0000   Max.   :1.0000  
                 NA's   :1188    NA's   :1188     NA's   :1188    
      priv      
 Min.   :0.000  
 1st Qu.:0.000  
 Median :0.000  
 Mean   :0.037  
 3rd Qu.:0.000  
 Max.   :1.000  
 NA's   :1188   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pisa2009_chl)      <span class="co"># Muestra la estructura interna del data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [5,669 × 13] (S3: tbl_df/tbl/data.frame)
 $ ctry  : chr+lbl [1:5669] 152, 152, 152, 152, 152, 152, 152, 152, 152, 152, 152...
   ..@ label        : chr "Country code ISO 3-digit"
   ..@ format.spss  : chr "A3"
   ..@ display_width: int 9
   ..@ labels       : Named chr "152"
   .. ..- attr(*, "names")= chr "CHL"
 $ school: chr [1:5669] "00001" "00001" "00001" "00001" ...
  ..- attr(*, "label")= chr "School ID 5-digit"
  ..- attr(*, "format.spss")= chr "A5"
  ..- attr(*, "display_width")= int 10
 $ id    : chr [1:5669] "00003" "00002" "00005" "00001" ...
  ..- attr(*, "label")= chr "Student ID 5-digit"
  ..- attr(*, "format.spss")= chr "A5"
  ..- attr(*, "display_width")= int 9
 $ sex   : dbl+lbl [1:5669] 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
   ..@ label        : chr "Sex"
   ..@ format.spss  : chr "F1.0"
   ..@ display_width: int 9
   ..@ labels       : Named num [1:2] 0 1
   .. ..- attr(*, "names")= chr [1:2] "Male" "Female"
 $ ses   : dbl+lbl [1:5669] -0.2907, -0.7978, -2.5471, -2.3071, -1.3214, -0.2655,...
   ..@ label        : chr "Index of economic, social and cultural status (WLE)"
   ..@ format.spss  : chr "F8.2"
   ..@ display_width: int 12
   ..@ labels       : Named num -999
   .. ..- attr(*, "names")= chr "missing"
 $ sesj  : dbl+lbl [1:5669] -1.453, -1.453, -1.453, -1.453, -1.453, -0.674, -0.67...
   ..@ label        : chr "school ses"
   ..@ format.spss  : chr "F8.2"
   ..@ display_width: int 10
   ..@ labels       : Named num -999
   .. ..- attr(*, "names")= chr "missing"
 $ math  : num [1:5669] 414 347 391 417 422 ...
  ..- attr(*, "label")= chr "Plausible value in math"
  ..- attr(*, "format.spss")= chr "F8.2"
  ..- attr(*, "display_width")= int 11
 $ read  : num [1:5669] 534 396 457 451 460 ...
  ..- attr(*, "label")= chr "Plausible value in reading"
  ..- attr(*, "format.spss")= chr "F8.1"
  ..- attr(*, "display_width")= int 11
 $ scie  : num [1:5669] 480 414 392 408 438 ...
  ..- attr(*, "label")= chr "Plausible value in science"
  ..- attr(*, "format.spss")= chr "F8.2"
  ..- attr(*, "display_width")= int 11
 $ type  : dbl+lbl [1:5669] NA, NA, NA, NA, NA,  2,  2,  2,  2,  2,  2,  2,  2,  ...
   ..@ label        : chr "School Type"
   ..@ format.spss  : chr "F1.0"
   ..@ display_width: int 9
   ..@ labels       : Named num [1:4] -999 1 2 3
   .. ..- attr(*, "names")= chr [1:4] "missing" "Public" "Private government-dependent" "Private independent"
 $ public: dbl+lbl [1:5669] NA, NA, NA, NA, NA,  0,  0,  0,  0,  0,  0,  0,  0,  ...
   ..@ label        : chr "public schools = 1, else = 0"
   ..@ format.spss  : chr "F8.2"
   ..@ display_width: int 10
   ..@ labels       : Named num [1:3] -999 0 1
   .. ..- attr(*, "names")= chr [1:3] "missing" "else" "public"
 $ subv  : dbl+lbl [1:5669] NA, NA, NA, NA, NA,  1,  1,  1,  1,  1,  1,  1,  1,  ...
   ..@ label        : chr "subv schools = 1, else = 0"
   ..@ format.spss  : chr "F8.2"
   ..@ display_width: int 10
   ..@ labels       : Named num [1:3] -999 0 1
   .. ..- attr(*, "names")= chr [1:3] "missing" "else" "subv"
 $ priv  : dbl+lbl [1:5669] NA, NA, NA, NA, NA,  0,  0,  0,  0,  0,  0,  0,  0,  ...
   ..@ label        : chr "priv schools = 1, else = 0"
   ..@ format.spss  : chr "F8.2"
   ..@ display_width: int 10
   ..@ labels       : Named num [1:3] -999 0 1
   .. ..- attr(*, "names")= chr [1:3] "missing" "else" "priv"</code></pre>
</div>
</div>
</section>
<section id="análisis-descriptivo" class="level2">
<h2 class="anchored" data-anchor-id="análisis-descriptivo">Análisis Descriptivo</h2>
<section id="estadísticos-descriptivos" class="level3">
<h3 class="anchored" data-anchor-id="estadísticos-descriptivos">Estadísticos Descriptivos</h3>
<p>Comenzamos con el análisis descriptivo del Índice de Estatus Económico, Social y Cultural (ESCS, por sus siglas en inglés en PISA) o simplemente estatus socioeconómico del estudiantes (<code>ses</code>) y del puntaje en matemáticas (<code>math</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pisa2009_chl<span class="sc">$</span>ses <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pisa2009_chl<span class="sc">$</span>ses)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pisa2009_chl<span class="sc">$</span>ses)  <span class="co"># Resumen descriptivo de SES</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
-4.2451 -1.3480 -0.5661 -0.5056  0.3615  2.8814      89 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(pisa2009_chl<span class="sc">$</span>ses, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Desviación estándar de SES</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.164141</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(pisa2009_chl<span class="sc">$</span>ses, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Varianza de SES</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.355225</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(pisa2009_chl<span class="sc">$</span>ses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars    n  mean   sd median trimmed  mad   min  max range skew kurtosis   se
X1    1 5580 -0.51 1.16  -0.57   -0.51 1.25 -4.25 2.88  7.13 0.05    -0.57 0.02</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pisa2009_chl<span class="sc">$</span>math)  <span class="co"># Resumen descriptivo de math</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  194.7   370.0   421.3   424.8   477.6   782.1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(pisa2009_chl<span class="sc">$</span>math, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Desviación estándar de math</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80.51892</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(pisa2009_chl<span class="sc">$</span>math, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Varianza de math</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6483.297</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(pisa2009_chl<span class="sc">$</span>math)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars    n   mean    sd median trimmed   mad    min    max  range skew
X1    1 5669 424.82 80.52 421.26  423.32 79.45 194.74 782.06 587.32 0.17
   kurtosis   se
X1    -0.07 1.07</code></pre>
</div>
</div>
</section>
<section id="visualización-de-la-distribución-de-los-datos" class="level3">
<h3 class="anchored" data-anchor-id="visualización-de-la-distribución-de-los-datos">Visualización de la Distribución de los Datos</h3>
<p>Para entender mejor la distribución de los datos, generamos varios gráficos usando el paquete <code>ggplot2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograma de SES</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pisa2009_chl, <span class="fu">aes</span>(<span class="at">x =</span> ses)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 89 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de Densidad de SES</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pisa2009_chl, <span class="fu">aes</span>(<span class="at">x =</span> ses)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 89 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograma y Densidad combinados</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pisa2009_chl, <span class="fu">aes</span>(<span class="at">x =</span> ses)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..)) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(density)` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 89 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 89 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograma de Math</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pisa2009_chl, <span class="fu">aes</span>(<span class="at">x =</span> math)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de Densidad de Math</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pisa2009_chl, <span class="fu">aes</span>(<span class="at">x =</span> math)) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-6-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograma y Densidad combinados</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pisa2009_chl, <span class="fu">aes</span>(<span class="at">x =</span> math)) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..)) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-6-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="análisis-de-regresión-lineal-1" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-regresión-lineal-1">Análisis de Regresión Lineal</h2>
<section id="regresión-lineal-simple" class="level3">
<h3 class="anchored" data-anchor-id="regresión-lineal-simple">Regresión Lineal Simple</h3>
<p>Realizaremos una regresión lineal simple para predecir el puntaje en matemáticas (math) utilizando el índice de estatus socioeconómico como predictor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(math <span class="sc">~</span> ses, <span class="at">data =</span> pisa2009_chl)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = math ~ ses, data = pisa2009_chl)

Residuals:
    Min      1Q  Median      3Q     Max 
-248.82  -47.51    0.17   48.69  341.76 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 441.7171     1.0435  423.30   &lt;2e-16 ***
ses          31.8753     0.8223   38.77   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 71.5 on 5578 degrees of freedom
  (89 observations deleted due to missingness)
Multiple R-squared:  0.2122,    Adjusted R-squared:  0.2121 
F-statistic:  1503 on 1 and 5578 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<section id="evaluación-de-los-supuestos-del-modelo-de-regresión" class="level4">
<h4 class="anchored" data-anchor-id="evaluación-de-los-supuestos-del-modelo-de-regresión">Evaluación de los Supuestos del Modelo de Regresión</h4>
<p>Es fundamental evaluar los supuestos estadísticos del modelo de regresión para asegurarnos de que los resultados sean válidos.</p>
<ul>
<li><strong>Supuesto de Linealidad</strong> El supuesto de linealidad indica que la relación entre el predictor (ses) y la variable dependiente (math) es lineal. Para evaluar la linealidad, podemos utilizar un diagrama de dispersión (scatter plot) que muestre la relación entre la variable predictora <code>ses</code> (Índice de Estatus Económico, Social y Cultural) y la variable dependiente <code>math</code> (Puntaje en Matemáticas).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pisa2009_chl) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> ses, <span class="at">y =</span> math) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"#0c4c8a"</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 89 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Interpretación:</em> Si los puntos en el gráfico muestran una tendencia a alinearse en una línea recta (ascendente o descendente), podemos asumir que la relación es aproximadamente lineal. Si los puntos siguen una forma curvilínea, la relación podría no ser lineal, lo que sugeriría la necesidad de transformar las variables o considerar un modelo diferente.</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="correlation_examples2.png" class="img-fluid quarto-figure quarto-figure-left figure-img" width="400"></p>
</figure>
</div>
<ul>
<li><p><strong>Supuesto de Normalidad de los Residuos</strong> El supuesto de normalidad de los residuos indica que los errores del modelo (es decir, las diferencias entre los valores observados y los valores predichos) deben distribuirse normalmente. Esto es crucial para validar las pruebas de significancia estadística (prueba <strong>t</strong> de Student) que se utiliza en la regresión. Para evaluar este supuesto, utilizamos varias aproximaciones:</p>
<ul>
<li>Histograma de los residuos: Permite observar la distribución de los errores.</li>
<li>Gráfico de densidad: Proporciona una visualización suave de la distribución de los residuos.</li>
<li>Gráfico Cuantil-Cuantil (Q-Q plot): Compara la distribución de los residuos con una distribución normal teórica.</li>
<li>Prueba de Shapiro-Wilk: Prueba estadística que evalúa la normalidad de los residuos.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(m1<span class="sc">$</span>residuals, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(m1<span class="sc">$</span>residuals))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(m1<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">'Gráfico Cuantil-Cuantil'</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(m1<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(m1<span class="sc">$</span>residuals[<span class="dv">0</span><span class="sc">:</span><span class="dv">5000</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  m1$residuals[0:5000]
W = 0.99936, p-value = 0.07203</code></pre>
</div>
</div>
<ul>
<li><strong>Supuesto de Homocedasticidad</strong> El supuesto de homocedasticidad establece que la varianza de los residuos es constante a lo largo de todos los valores de la variable predictora. Esto significa que los errores del modelo no deberían mostrar patrones sistemáticos cuando se grafican contra los valores predichos. La falta de homocedasticidad, conocida como heterocedasticidad, puede llevar a estimaciones sesgadas de los coeficientes de regresión.</li>
</ul>
<p>Para evaluar este supuesto, utilizamos el test de Breusch-Pagan, que es una prueba estadística que evalúa la presencia de heterocedasticidad. Si el test de Breusch-Pagan indica Un valor <em>p</em> &gt; .05, entonces este sugiere que no se puede rechazar la hipótesis nula de homocedasticidad, indicando que la varianza de los residuos es constante. Si el valor <em>p</em> es menor a 0.05, hay evidencia de heterocedasticidad, lo que podría requerir la transformación de variables o el uso de un modelo robusto.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(math <span class="sc">~</span> ses, <span class="at">data =</span> pisa2009_chl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  math ~ ses
BP = 26.143, df = 1, p-value = 3.17e-07</code></pre>
</div>
</div>
</section>
</section>
<section id="regresión-lineal-múltiple" class="level3">
<h3 class="anchored" data-anchor-id="regresión-lineal-múltiple">Regresión Lineal Múltiple</h3>
<p>A continuación, realizamos una regresión lineal múltiple, agregando más predictores al modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificación de la variable sexo</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>pisa2009_chl<span class="sc">$</span>female <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pisa2009_chl<span class="sc">$</span>sex)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>pisa2009_chl<span class="sc">$</span>female[pisa2009_chl<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>pisa2009_chl<span class="sc">$</span>female[pisa2009_chl<span class="sc">$</span>female <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(math <span class="sc">~</span> ses <span class="sc">+</span> female <span class="sc">+</span> read <span class="sc">+</span> scie, <span class="at">data =</span> pisa2009_chl)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = math ~ ses + female + read + scie, data = pisa2009_chl)

Residuals:
     Min       1Q   Median       3Q      Max 
-124.217  -23.367    0.453   23.630  150.240 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  49.51870    3.17913   15.58   &lt;2e-16 ***
ses           6.11399    0.45122   13.55   &lt;2e-16 ***
female      -27.48366    1.00307  -27.40   &lt;2e-16 ***
read          0.43488    0.01136   38.28   &lt;2e-16 ***
scie          0.43103    0.01114   38.68   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 35.17 on 5575 degrees of freedom
  (89 observations deleted due to missingness)
Multiple R-squared:  0.8094,    Adjusted R-squared:  0.8093 
F-statistic:  5920 on 4 and 5575 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><strong>Evaluación de la Multicolinealidad</strong> En este caso como tenemos 2 o más predictores, debemos evaluar la multicolinealidad en el modelo. La multicolinealidad ocurre cuando dos o más variables predictoras en un modelo de regresión están altamente correlacionadas entre sí. Esto puede ser problemático porque impide la estimación de un modelo de regresión. Para ello, observamos las correlaciones entre los predictores y calculamos el factor de inflación de la varianza (VIF).</li>
</ul>
<p>Podemos evaluar la presencia de multicolinealidad en un modelo de regresión generando una matriz de correlación de los predictores puede dar una idea inicial sobre las relaciones bivariadas entre ellos. Observamos si hay correlaciones altas (generalmente <strong>r</strong> &gt; 0.8 o &lt; -0.8) entre dos variables predictoras pueden ser una indicador de multicolinealidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> pisa2009_chl[, <span class="fu">c</span>(<span class="st">"math"</span>, <span class="st">"ses"</span>, <span class="st">"read"</span>, <span class="st">"scie"</span>)]</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>correlaciones <span class="ot">&lt;-</span> <span class="fu">cor</span>(data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar la matriz de correlación usando un correlograma</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlaciones, <span class="at">method =</span> <span class="st">'circle'</span>, <span class="at">type =</span> <span class="st">'lower'</span>, <span class="at">insig =</span> <span class="st">'blank'</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">'black'</span>, <span class="at">number.cex =</span> <span class="fl">0.8</span>, <span class="at">order =</span> <span class="st">'AOE'</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>También, podemos estimar el factor de inflación de la varianza (VIF). El VIF mide cuánto la varianza de un coeficiente de regresión está inflada debido a la multicolinealidad. Un VIF de 1 indica que no hay correlación entre la variable predictora y las demás variables predictoras. Un VIF entre 1 y 5 sugiere una correlación moderada pero aceptable. Un VIF mayor que 5 (algunos usan el umbral de 10) indica una alta multicolinealidad que podría ser problemática.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">vif</span>(m2), <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ses</td>
<td style="text-align: right;">1.24</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">1.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">read</td>
<td style="text-align: right;">3.94</td>
</tr>
<tr class="even">
<td style="text-align: left;">scie</td>
<td style="text-align: right;">3.77</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Interpretación: Si alguna de las variables en el modelo tiene un VIF alto (por ejemplo, mayor a 5), esto indica que la variable está altamente correlacionada con una o más de las otras variables predictoras, lo que sugiere multicolinealidad.</p>
<p><strong>¿Qué hacer si hay multicolinealidad?</strong> - Eliminar una de las variables correlacionadas: Si dos variables están altamente correlacionadas, podrías considerar eliminar una de ellas para reducir la multicolinealidad. - Transformar las variables: En algunos casos, la transformación de las variables (por ejemplo, usando logaritmos o diferencias) puede reducir la multicolinealidad.</p>
<p>Esta función obtiene gráficos de diagnóstico para chequear supuestos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller-3a_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Comparación de Modelos</strong> Finalmente, comparamos los dos modelos de regresión para determinar cuál ajusta mejor los datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1, m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: math ~ ses
Model 2: math ~ ses + female + read + scie
  Res.Df      RSS Df Sum of Sq      F    Pr(&gt;F)    
1   5578 28513803                                  
2   5575  6897626  3  21616176 5823.8 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Importancia Relativa de los Predictores</strong> Calculamos la importancia relativa de cada predictor en el modelo de regresión múltiple.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calc.relimp</span>(m2, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"lmg"</span>, <span class="st">"last"</span>, <span class="st">"first"</span>, <span class="st">"pratt"</span>), <span class="at">rela =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response variable: math 
Total response variance: 6487.868 
Analysis based on 5580 observations 

4 Regressors: 
ses female read scie 
Proportion of variance explained by model: 80.94%
Metrics are normalized to sum to 100% (rela=TRUE). 

Relative importance metrics: 

              lmg       last      first      pratt
ses    0.09538154 0.04712198 0.12826346 0.05029273
female 0.03280761 0.19267618 0.01166592 0.02928425
read   0.42029914 0.37617459 0.41469487 0.45443514
scie   0.45151171 0.38402725 0.44537575 0.46598788

Average coefficients for different model sizes: 

                1X         2Xs         3Xs         4Xs
ses     31.8752522  16.5316474   7.7593596   6.1139866
female -22.3815763 -25.7060191 -27.3885498 -27.4836607
read     0.8112476   0.6533462   0.5299906   0.4348758
scie     0.8421612   0.7226368   0.5842692   0.4310344</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>